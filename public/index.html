<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IntelliMen - 53 Desafios Para Homens Inteligentes</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#000000">
    <meta name="description" content="53 Desafios para transformar homens em IntelliMen - Desenvolvimento pessoal baseado no livro de Renato Cardoso">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icon-192x192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #000000;
            --secondary-color: #333333;
            --accent-color: #f8f9fa;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --text-color: #1f2937;
            --text-light: #6b7280;
            --border-color: #e5e7eb;
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --border-radius: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #333333 100%);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Loading Spinner */
        .loading-spinner {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            backdrop-filter: blur(4px);
        }

        .spinner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left: 4px solid #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background: white;
            padding: 16px 24px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            border-left: 4px solid var(--success-color);
            transform: translateX(400px);
            animation: slideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            max-width: 400px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toast.error {
            border-left-color: var(--danger-color);
        }

        .toast.warning {
            border-left-color: var(--warning-color);
        }

        @keyframes slideIn {
            to { transform: translateX(0); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #333333 100%);
            color: white;
            padding: 40px 0;
            margin-bottom: 40px;
            position: relative;
            border-radius: 24px;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(255,255,255,0.05) 0%, transparent 50%);
            z-index: 1;
        }

        .header-content {
            position: relative;
            z-index: 2;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            gap: 20px;
        }

        .logo-icon {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            color: #000;
            font-size: 20px;
            box-shadow: var(--shadow);
        }

        .header-brand {
            font-size: 3rem;
            font-weight: 900;
            letter-spacing: 3px;
            background: linear-gradient(45deg, #ffffff, #e5e7eb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.9;
            font-weight: 400;
            margin-bottom: 15px;
        }

        .header-subtitle {
            font-size: 1.1rem;
            color: #d1d5db;
            font-style: italic;
            margin-top: 10px;
        }

        /* Auth Section */
        .auth-section {
            background: white;
            border-radius: 24px;
            padding: 50px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 40px;
            border: 1px solid var(--border-color);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 40px;
            background: var(--accent-color);
            border-radius: var(--border-radius);
            padding: 8px;
        }

        .auth-tab {
            flex: 1;
            padding: 16px 24px;
            text-align: center;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-light);
            border-radius: calc(var(--border-radius) - 8px);
            transition: var(--transition);
        }

        .auth-tab.active {
            background: white;
            color: var(--primary-color);
            box-shadow: var(--shadow);
        }

        .auth-form {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .auth-form.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 0.95rem;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-family: inherit;
            transition: var(--transition);
            background: white;
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background: var(--primary-color);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #059669);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color), #dc2626);
        }

        .btn-full {
            width: 100%;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Dashboard */
        .dashboard {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .dashboard.active {
            display: block;
        }

        .dashboard-header {
            background: white;
            border-radius: 24px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
        }

        .user-welcome {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            font-weight: 900;
            box-shadow: var(--shadow);
        }

        .user-details h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .user-details p {
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .level-badge {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            padding: 8px 16px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-top: 8px;
        }

        .dashboard-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .dashboard-actions .btn {
            padding: 12px 20px;
            font-size: 0.95rem;
        }

        /* Progress Section */
        .progress-section {
            background: white;
            border-radius: 24px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .progress-header h3 {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--accent-color);
            padding: 24px;
            border-radius: var(--border-radius);
            text-align: center;
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .stat-label {
            color: var(--text-light);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .progress-bar-container {
            background: var(--accent-color);
            height: 24px;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            margin-bottom: 20px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color), #10b981);
            border-radius: 12px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            text-align: center;
            font-weight: 600;
            color: var(--text-color);
            margin-top: 10px;
        }

        /* Challenges Grid */
        .challenges-section {
            margin-bottom: 40px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .section-header h3 {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .filter-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(10px);
        }

        .filter-btn.active,
        .filter-btn:hover {
            background: white;
            color: var(--primary-color);
            border-color: white;
        }

        .challenges-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 24px;
            margin-top: 30px;
        }

        .challenge-card {
            background: white;
            border-radius: 20px;
            padding: 28px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .challenge-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--text-light), var(--border-color));
            transition: var(--transition);
        }

        .challenge-card.completed::before {
            background: linear-gradient(90deg, var(--success-color), #10b981);
        }

        .challenge-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .challenge-card.completed {
            background: linear-gradient(135deg, #f0fdf4, #ecfdf5);
            border-color: var(--success-color);
        }

        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .challenge-number {
            background: var(--primary-color);
            color: white;
            padding: 10px 16px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.9rem;
            min-width: 50px;
            text-align: center;
        }

        .challenge-status {
            padding: 6px 14px;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .challenge-status.pending {
            background: #fef3c7;
            color: #d97706;
        }

        .challenge-status.completed {
            background: #d1fae5;
            color: #059669;
        }

        .challenge-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--text-color);
            line-height: 1.4;
        }

        .challenge-description {
            color: var(--text-light);
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 0.95rem;
        }

        .challenge-links {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .challenge-link {
            background: var(--accent-color);
            color: var(--text-color);
            padding: 8px 14px;
            border-radius: 50px;
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 600;
            transition: var(--transition);
            border: 1px solid var(--border-color);
        }

        .challenge-link:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .challenge-progress {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border-color);
        }

        .challenge-progress .btn {
            flex: 1;
            padding: 10px 16px;
            font-size: 0.9rem;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(8px);
            animation: fadeIn 0.3s ease-out;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 40px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }

        .modal-header h2 {
            font-size: 1.6rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .close-btn {
            background: var(--accent-color);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--text-light);
            transition: var(--transition);
        }

        .close-btn:hover {
            background: var(--danger-color);
            color: white;
            transform: rotate(90deg);
        }

        .notes-section {
            margin-top: 30px;
            padding: 25px;
            background: var(--accent-color);
            border-radius: var(--border-radius);
            border: 2px solid var(--border-color);
        }

        .notes-section h4 {
            margin-bottom: 16px;
            color: var(--text-color);
            font-size: 1.2rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notes-section textarea {
            width: 100%;
            min-height: 150px;
            resize: vertical;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 20px;
            font-family: inherit;
            font-size: 1rem;
            line-height: 1.6;
            transition: var(--transition);
        }

        .notes-section textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header-brand {
                font-size: 2rem;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .header p {
                font-size: 1.1rem;
            }

            .auth-section,
            .dashboard-header,
            .progress-section {
                padding: 25px;
            }

            .challenges-grid {
                grid-template-columns: 1fr;
            }

            .user-welcome {
                flex-direction: column;
                text-align: center;
            }

            .dashboard-actions {
                justify-content: center;
                width: 100%;
            }

            .dashboard-actions .btn {
                flex: 1;
                min-width: 120px;
            }

            .modal-content {
                margin: 10px;
                padding: 25px;
                max-height: 85vh;
            }

            .progress-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .filter-buttons {
                justify-content: center;
            }

            .section-header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .header-logo {
                flex-direction: column;
                gap: 15px;
            }

            .logo-icon {
                width: 60px;
                height: 60px;
                font-size: 16px;
            }

            .progress-stats {
                grid-template-columns: 1fr;
            }

            .auth-tabs {
                flex-direction: column;
                gap: 8px;
            }

            .user-info {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="header-logo">
                    <div class="logo-icon">IM</div>
                    <div class="header-brand">INTELLIMEN</div>
                </div>
                <h1>PROJETO INTELLIMEN</h1>
                <p>53 Desafios Para Homens Inteligentes</p>
                <div class="header-subtitle">Transforme-se em um homem melhor atrav√©s de desafios pr√°ticos</div>
            </div>
        </div>

        <!-- Se√ß√£o de Autentica√ß√£o -->
        <div class="auth-section" id="authSection">
            <div class="auth-tabs">
                <button class="auth-tab active" id="loginTab">üîë Login</button>
                <button class="auth-tab" id="registerTab">üìù Cadastro</button>
            </div>

            <div class="auth-form active" id="loginForm">
                <h2>Bem-vindo de volta!</h2>
                <p style="color: var(--text-light); margin-bottom: 30px;">Entre com suas credenciais para continuar sua jornada IntelliMen</p>
                <form id="actualLoginForm">
                    <div class="form-group">
                        <label for="loginEmail">üìß Email:</label>
                        <input type="email" id="loginEmail" value="joao@email.com" required placeholder="seu-email@exemplo.com">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">üîí Senha:</label>
                        <input type="password" id="loginPassword" value="123456" required placeholder="Digite sua senha">
                    </div>
                    <button type="submit" class="btn btn-full">
                        <span>Entrar no IntelliMen</span>
                        <span>üöÄ</span>
                    </button>
                </form>
                <p style="margin-top: 20px; text-align: center; color: var(--text-light); font-size: 0.9rem;">
                    üí° <strong>Para testar:</strong> joao@email.com | 123456
                </p>
            </div>

            <div class="auth-form" id="registerForm">
                <h2>Junte-se aos IntelliMen</h2>
                <p style="color: var(--text-light); margin-bottom: 30px;">Comece sua jornada de transforma√ß√£o pessoal</p>
                <form id="actualRegisterForm">
                    <div class="form-group">
                        <label for="registerName">üë§ Nome Completo:</label>
                        <input type="text" id="registerName" required placeholder="Seu nome completo">
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">üìß Email:</label>
                        <input type="email" id="registerEmail" required placeholder="seu-email@exemplo.com">
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">üîí Senha:</label>
                        <input type="password" id="registerPassword" required placeholder="Crie uma senha segura">
                    </div>
                    <div class="form-group">
                        <label for="registerPartner">ü§ù Parceiro Oficial (Opcional):</label>
                        <input type="text" id="registerPartner" placeholder="Nome do seu parceiro IntelliMen">
                        <small style="color: var(--text-light); font-size: 0.85rem; margin-top: 5px; display: block;">
                            Um parceiro te ajuda a manter a responsabilidade e motiva√ß√£o
                        </small>
                    </div>
                    <button type="submit" class="btn btn-full">
                        <span>Come√ßar Jornada</span>
                        <span>‚ú®</span>
                    </button>
                </form>
            </div>
        </div>

        <!-- Dashboard -->
        <div class="dashboard" id="dashboard">
            <!-- User Header -->
            <div class="dashboard-header">
                <div class="user-welcome">
                    <div class="user-info">
                        <div class="user-avatar" id="userAvatar">IM</div>
                        <div class="user-details">
                            <h2>Ol√°, <span id="userName"></span>! üëã</h2>
                            <p>ü§ù Parceiro: <span id="partnerName">N√£o definido</span></p>
                            <div class="level-badge" id="levelBadge">
                                <span>üèÜ</span>
                                <span id="userLevel">Iniciante</span>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-actions">
                        <button class="btn btn-secondary" onclick="openProfileModal()">
                            <span>üë§</span>
                            <span>Perfil</span>
                        </button>
                        <button class="btn btn-secondary" onclick="exportProgress()">
                            <span>üìÑ</span>
                            <span>Exportar</span>
                        </button>
                        <button class="btn btn-secondary" onclick="openManifestoModal()">
                            <span>üìú</span>
                            <span>Manifesto</span>
                        </button>
                        <button class="btn btn-danger" onclick="logout()">
                            <span>üö™</span>
                            <span>Sair</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Progress Section -->
            <div class="progress-section">
                <div class="progress-header">
                    <h3>
                        <span>üìä</span>
                        <span>Seu Progresso</span>
                    </h3>
                    <button class="btn btn-secondary" onclick="shareProgress()">
                        <span>üì±</span>
                        <span>Compartilhar</span>
                    </button>
                </div>

                <div class="progress-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="completedChallenges">0</div>
                        <div class="stat-label">Desafios Conclu√≠dos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="progressPercentage">0%</div>
                        <div class="stat-label">Progresso Total</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="currentStreak">0</div>
                        <div class="stat-label">Sequ√™ncia Atual</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="daysActive">0</div>
                        <div class="stat-label">Dias Ativos</div>
                    </div>
                </div>

                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                </div>
                <div class="progress-text">
                    <span id="progressText">0/53 desafios conclu√≠dos</span>
                </div>
            </div>

            <!-- Lema Section -->
            <div style="background: linear-gradient(135deg, #000000 0%, #333333 100%); color: white; padding: 40px; border-radius: 24px; margin: 40px 0; text-align: center; border: 3px solid var(--primary-color); position: relative; overflow: hidden;">
                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.1) 0%, transparent 50%), radial-gradient(circle at 70% 80%, rgba(255,255,255,0.05) 0%, transparent 50%); z-index: 1;"></div>
                <div style="position: relative; z-index: 2;">
                    <h3 style="margin-bottom: 20px; font-size: 1.8rem; font-weight: 700;">üéØ Lema do IntelliMan</h3>
                    <p style="font-style: italic; line-height: 1.8; font-size: 1.2rem; font-weight: 400; margin: 0;">
                        "Um IntelliMan √© um homem inteligente. Ele vence a si mesmo, honra sua mulher e ajuda o seu parceiro. 
                        Se √© dif√≠cil, ele supera. Se √© assustador, ele enfrenta. Se demora, ele persevera. 
                        Conhece o seu valor diante dos homens e de Deus. Ama a disciplina, o car√°ter e o bem. 
                        Sua miss√£o √© inspirar outros a se tornarem IntelliMen."
                    </p>
                </div>
            </div>

            <!-- Challenges Section -->
            <div class="challenges-section">
                <div class="section-header">
                    <h3>
                        <span>üéØ</span>
                        <span>53 Desafios IntelliMen</span>
                    </h3>
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all">Todos</button>
                        <button class="filter-btn" data-filter="completed">Conclu√≠dos</button>
                        <button class="filter-btn" data-filter="pending">Pendentes</button>
                        <button class="filter-btn" data-filter="foundation">Funda√ß√£o</button>
                        <button class="filter-btn" data-filter="discipline">Disciplina</button>
                        <button class="filter-btn" data-filter="excellence">Excel√™ncia</button>
                        <button class="filter-btn" data-filter="impact">Impacto</button>
                    </div>
                </div>

                <div class="challenges-grid" id="challengesGrid">
                    <!-- Desafios ser√£o carregados aqui -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Perfil do Usu√°rio -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <span>üë§</span>
                    <span>Perfil do IntelliMan</span>
                </h2>
                <button class="close-btn" onclick="closeProfileModal()">&times;</button>
            </div>
            <div>
                <h3 style="margin-bottom: 20px;">üìã Informa√ß√µes Pessoais</h3>
                <form id="profileForm" onsubmit="updateProfile(event)">
                    <div class="form-group">
                        <label for="profileName">Nome Completo:</label>
                        <input type="text" id="profileName" required>
                    </div>
                    <div class="form-group">
                        <label for="profileEmail">Email:</label>
                        <input type="email" id="profileEmail" readonly style="background: var(--accent-color); opacity: 0.7;">
                        <small style="color: var(--text-light); font-size: 0.85rem;">O email n√£o pode ser alterado</small>
                    </div>
                    <div class="form-group">
                        <label for="profilePartner">Parceiro Oficial:</label>
                        <input type="text" id="profilePartner" placeholder="Nome do seu parceiro oficial">
                    </div>
                    <button type="submit" class="btn btn-success btn-full">
                        <span>üíæ</span>
                        <span>Atualizar Dados</span>
                    </button>
                </form>
                
                <hr style="margin: 30px 0; border: 1px solid var(--border-color);">
                
                <h3 style="margin-bottom: 20px;">üìä Estat√≠sticas Detalhadas</h3>
                <div id="profileStats" style="background: var(--accent-color); padding: 25px; border-radius: var(--border-radius); border: 1px solid var(--border-color);">
                    <!-- Estat√≠sticas ser√£o carregadas aqui -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Manifesto -->
    <div class="modal" id="manifestoModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>
                    <span>üìú</span>
                    <span>Manifesto do IntelliMen</span>
                </h2>
                <button class="close-btn" onclick="closeManifestoModal()">&times;</button>
            </div>
            <div style="max-height: 60vh; overflow-y: auto; line-height: 1.7;">
                <h3 style="color: var(--primary-color); margin-bottom: 20px;">MANIFESTO</h3>
                <p style="margin-bottom: 20px;">Ser homem antigamente era algo muito simples. Voc√™ aprendia duas coisas desde cedo: lutar para se defender e ca√ßar para se alimentar. Quem fazia isso muito bem, se dava muito bem. E levava a garota para casa.</p>
                
                <p style="margin-bottom: 20px;">Esse era o crit√©rio b√°sico quando o pai considerava um rapaz para casar com sua filha. E ela tamb√©m. Em muitos casos, amor era secund√°rio. Voc√™ n√£o ouvia mulheres detalhando uma longa lista de atributos que queriam no futuro marido.</p>
                
                <p style="margin-bottom: 20px;">A √∫nica preocupa√ß√£o era: "Voc√™ pode e est√° pronto para me proteger com a sua vida? Pode me sustentar t√£o bem quanto ou melhor que o meu pai? Ent√£o ponha um anel aqui..." Simples assim.</p>
                
                <p style="margin-bottom: 20px;"><strong>Ser homem no s√©culo 21 j√° √© outra hist√≥ria.</strong> O mundo mudou. As mulheres mudaram. E muitos homens ainda est√£o com a cabe√ßa l√° atr√°s. O resultado est√° a√≠ para ser assistido em 3D: homens <strong>Deslocados, Despreparados e Desacreditados</strong>.</p>
                
                <hr style="margin: 30px 0; border: 1px solid var(--border-color);">
                
                <h3 style="color: var(--primary-color); margin-bottom: 20px;">APRESENTANDO O INTELLIMEN</h3>
                <p style="margin-bottom: 20px;">Voc√™ j√° deve ter sacado que o nome do projeto √© uma jun√ß√£o das palavras em ingl√™s <em>intelligent</em> (inteligentes) e <em>men</em> (homens). Escolhemos esse nome porque, al√©m de soar como um super-her√≥i (que todo homem secretamente aspira ser desde crian√ßa), ele engloba tudo a que o projeto aspira: <strong>formar homens inteligentes e melhores em tudo</strong>.</p>
                
                <p style="margin-bottom: 20px;">Formar homens melhores ser√° o nosso lema. Ser homens inteligentes √© a nossa miss√£o. Vamos caminhar juntos, aprender uns com os outros. Mas espere <strong>DESAFIOS</strong>. N√≥s vamos desafi√°-lo a ser melhor em todas as √°reas de sua vida.</p>
                
                <blockquote style="background: var(--accent-color); padding: 20px; border-left: 4px solid var(--primary-color); margin: 25px 0; font-style: italic; border-radius: var(--border-radius);">
                    "O homem n√£o prevalece pela for√ßa." - 1 Samuel 2.9
                </blockquote>
                
                <p style="margin-bottom: 20px;">√â preciso mais que m√∫sculos para ser homem. <strong>Car√°ter, intelig√™ncia e f√© s√£o muito mais importantes.</strong></p>
                
                <hr style="margin: 30px 0; border: 1px solid var(--border-color);">
                
                <h3 style="color: var(--primary-color); margin-bottom: 20px;">üéØ LEMA DO INTELLIMAN</h3>
                <div style="background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%); color: white; padding: 25px; border-radius: var(--border-radius); text-align: center; margin: 25px 0;">
                    <p style="font-size: 1.2rem; margin: 0; font-style: italic; line-height: 1.6;">
                        "Um IntelliMan √© um homem inteligente. Ele vence a si mesmo, honra sua mulher e ajuda o seu parceiro. Se √© dif√≠cil, ele supera. Se √© assustador, ele enfrenta. Se demora, ele persevera. Conhece o seu valor diante dos homens e de Deus. Ama a disciplina, o car√°ter e o bem. Sua miss√£o √© inspirar outros a se tornarem IntelliMen."
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Desafios -->
    <div class="modal" id="challengeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle"></h2>
                <button class="close-btn" onclick="closeChallengeModal()">&times;</button>
            </div>
            <div id="modalContent"></div>
            <div class="notes-section">
                <h4>
                    <span>üìù</span>
                    <span>Suas Anota√ß√µes Pessoais</span>
                </h4>
                <textarea id="challengeNotes" placeholder="‚úçÔ∏è Compartilhe suas reflex√µes, aprendizados e experi√™ncias com este desafio...

üí° Dicas para suas anota√ß√µes:
‚Ä¢ Como voc√™ se sentiu fazendo este desafio?
‚Ä¢ Quais dificuldades encontrou?
‚Ä¢ O que aprendeu sobre si mesmo?
‚Ä¢ Como vai aplicar isso no dia a dia?
‚Ä¢ Que decis√µes tomou em decorr√™ncia deste desafio?
‚Ä¢ Como seu parceiro pode te ajudar neste desafio?"></textarea>
                <button class="btn btn-success btn-full" id="completeBtn" onclick="completeChallenge()">
                    <span>‚úÖ</span>
                    <span>Salvar e Marcar como Conclu√≠do</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        console.log('üöÄ IntelliMen Sistema Completo iniciando...');
        
        // Configura√ß√£o da API
        const API_BASE_URL = window.location.origin;
        console.log('API Base URL:', API_BASE_URL);
        
        // Vari√°veis globais
        let currentUser = null;
        let currentChallengeId = null;
        let userProgress = [];
        let allChallenges = [];

        // Sistema de Toasts
        function showToast(message, type = 'success') {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icon = type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ö†Ô∏è';
            toast.innerHTML = `
                <span style="font-size: 1.2rem;">${icon}</span>
                <span>${message}</span>
            `;
            
            toastContainer.appendChild(toast);
            
            // Remover ap√≥s 4 segundos
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease-in-out forwards';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 4000);
        }

        // Sistema de Loading
        function showLoading() {
            document.getElementById('loadingSpinner').style.display = 'block';
        }

        function hideLoading() {
            document.getElementById('loadingSpinner').style.display = 'none';
        }

        // Dados completos dos 53 desafios
        const challenges = [
            {
                id: 1,
                title: "Encontrar um Parceiro Oficial",
                description: "Encontrar um parceiro para fazer o projeto com voc√™ e tornar p√∫blica sua participa√ß√£o.",
                details: "Voc√™ vai convidar algu√©m para come√ßar o Projeto IntelliMen com voc√™. Pode ser um amigo, irm√£o, colega no trabalho ou na igreja, primo, seu pai, seu filho, seu pastor etc. Escolha algu√©m legal, que vai levar o projeto a s√©rio e n√£o deix√°-lo na m√£o no meio do caminho.",
                category: "foundation",
                links: [
                    { text: "üåê P√°gina oficial do IntelliMen", url: "https://facebook.com/intellimen" },
                    { text: "üê¶ Twitter do IntelliMen", url: "https://twitter.com/intellimen27" }
                ]
            },
            {
                id: 2,
                title: "Identificar Tr√™s Coisas para Melhorar",
                description: "Identificar tr√™s coisas que voc√™ precisa melhorar sobre si mesmo com urg√™ncia.",
                details: "Todos n√≥s temos que melhorar em muitas coisas. Mas n√£o podemos fazer tudo ao mesmo tempo. Por isso voc√™ deve come√ßar com tr√™s √°reas de sua vida onde precisa melhorar com mais urg√™ncia. Pense em coisas que far√£o uma grande diferen√ßa na sua vida, o mais r√°pido poss√≠vel.",
                category: "foundation"
            },
            {
                id: 3,
                title: "Descobrir Suas Qualidades",
                description: "Descobrir as suas qualidades principais.",
                details: "Sua tarefa neste desafio ser√° escrever todas as suas qualidades como pessoa. No desafio anterior, buscamos onde precisamos melhorar, mas neste desafio vamos focar nas qualidades que j√° temos, onde j√° somos bons e competentes.",
                category: "foundation"
            },
            {
                id: 4,
                title: "Tempo com Familiar",
                description: "Reservar tempo com um familiar fazendo algo de que ele goste.",
                details: "IntelliMen s√£o voltados para suas fam√≠lias. Voc√™ vai tirar um tempo para fazer algo com ele ou por ele, algo de que ele goste. Pode ser sua esposa, sua m√£e, seu pai, irm√£o, av√¥, irm√£, filho ‚Äî enfim, uma pessoa que v√° apreciar seu gesto e tempo.",
                category: "foundation"
            },
            {
                id: 5,
                title: "S√©rie 'Seja Homem!'",
                description: "Assistir √† s√©rie de v√≠deos 'Seja Homem!' e refletir sobre seu papel como homem.",
                details: "Voc√™ vai assistir √† s√©rie de cinco v√≠deos sobre como ser homem nos dias de hoje. Cada v√≠deo dever√° ser acompanhado de anota√ß√µes sobre o que voc√™ aprendeu e as decis√µes que tomar√°.",
                category: "foundation",
                links: [
                    { text: "üé• Assistir √† s√©rie Seja Homem!", url: "http://rna.to/UtVFqR" }
                ]
            },
            {
                id: 6,
                title: "Revis√£o e Divulga√ß√£o",
                description: "Rever os resultados dos primeiros 5 desafios e falar do projeto com algu√©m.",
                details: "Passado um m√™s do in√≠cio do Projeto, √© hora de uma revis√£o. Voc√™ vai rever o que fez, avaliar os resultados e compartilhar com algu√©m o que tem sido bom para voc√™ no IntelliMen.",
                category: "foundation"
            },
            {
                id: 7,
                title: "Definir Objetivos Inteligentes",
                description: "Aprender a definir objetivos inteligentemente e colocar em pr√°tica.",
                details: "Voc√™ vai aprender sobre objetivos TRACQ (Tem prazo, Relevante, Alcan√ß√°vel, Claro e espec√≠fico, Quantificado) e definir um objetivo que tenha essas cinco caracter√≠sticas.",
                category: "foundation"
            },
            {
                id: 8,
                title: "Encontrar e Dominar",
                description: "Encontrar algo que o esteja dominando e passar a domin√°-lo.",
                details: "O homem foi criado para dominar e n√£o ser dominado por nada. Voc√™ vai identificar as coisas que t√™m lhe dominado e desenvolver estrat√©gias para domin√°-las.",
                category: "foundation",
                links: [
                    { text: "üé• O desafio de ser homem", url: "http://rna.to/1n6xZR7" }
                ]
            },
            {
                id: 9,
                title: "Atitude Ousada e Corajosa",
                description: "Tomar uma atitude ousada e corajosa por uma boa causa.",
                details: "Voc√™ vai procurar algo corajoso e ousado para fazer por uma boa causa. Identifique uma boa causa e pense em algo ousado que voc√™ pode fazer por ela.",
                category: "foundation",
                links: [
                    { text: "üé• Men stealing meat from lions", url: "https://www.youtube.com/watch?v=QDubMeNlSxc" }
                ]
            },
            {
                id: 10,
                title: "Despertar a Raiva Inteligente",
                description: "Despertar sua raiva contra algo errado e us√°-la inteligentemente.",
                details: "Voc√™ vai identificar situa√ß√µes na SUA VIDA que deveriam lhe provocar raiva, mas voc√™ tem sido passivo diante delas. Desperte sua raiva e use-a de forma inteligente.",
                category: "foundation",
                links: [
                    { text: "üìñ A origem da raiva", url: "http://rna.to/1hQTrMy" }
                ]
            },
            {
                id: 11,
                title: "Disciplina de Exerc√≠cios",
                description: "Entrar na disciplina de fazer exerc√≠cio f√≠sico pelo menos tr√™s vezes por semana.",
                details: "O homem inteligente deve ser a imagem da disciplina. Voc√™ vai adotar a disciplina de se exercitar regularmente - no m√≠nimo tr√™s vezes por semana, uma hora por sess√£o.",
                category: "discipline"
            },
            {
                id: 12,
                title: "Vigiar os Pensamentos",
                description: "Vigiar seus pensamentos e remover todos os que n√£o lhe fazem bem.",
                details: "Voc√™ vai vasculhar sua mente para identificar pensamentos ruins e ficar atento √† sua voz interior. Ao identificar algo negativo, imediatamente repreenda-o e fale algo positivo.",
                category: "discipline",
                links: [
                    { text: "üé• Como superar os maus pensamentos", url: "http://rna.to/1oeCnCE" }
                ]
            },
            {
                id: 13,
                title: "Ser Mais Cavalheiro",
                description: "Aprender a ser mais cavalheiro e menos cavalo.",
                details: "Voc√™ vai buscar praticar pequenos gestos e h√°bitos de um cavalheiro, tratando bem o seu semelhante, especialmente as mulheres, sem perder a masculinidade.",
                category: "discipline"
            },
            {
                id: 14,
                title: "Disciplina Financeira",
                description: "Disciplinar-se em guardar uma quantidade de dinheiro regularmente.",
                details: "Voc√™ vai criar uma disciplina financeira de n√£o gastar todo seu dinheiro, sempre. Considere o princ√≠pio 10-20-70: devolva 10% para Deus, guarde 20% e viva com 70% da sua renda.",
                category: "discipline"
            },
            {
                id: 15,
                title: "Disciplina do Todo-Poderoso",
                description: "Reconhecer a disciplina do Todo-Poderoso e aceit√°-la.",
                details: "Voc√™ vai reconhecer a disciplina de Deus na sua vida. Se Ele disciplina a quantos ama, voc√™ deve ser sens√≠vel a essa disciplina e aceit√°-la para seu crescimento.",
                category: "discipline"
            },
            {
                id: 16,
                title: "Pacto com os Olhos",
                description: "Fazer um pacto com seus olhos de n√£o cobi√ßar nenhuma mulher.",
                details: "Voc√™ vai treinar os seus olhos a n√£o olhar para mulheres com desejo ou cobi√ßa. Quando perceber que olhou, desvie o olhar imediatamente.",
                category: "discipline"
            },
            {
                id: 17,
                title: "Revis√£o dos Desafios",
                description: "Rever todos os desafios at√© aqui e se atualizar no projeto.",
                details: "Foram 16 desafios at√© aqui. Voc√™ vai fazer uma revis√£o completa, lembrando dos aprendizados e se atualizando nos desafios que n√£o completou satisfatoriamente.",
                category: "discipline"
            },
            {
                id: 18,
                title: "Ensinar uma Habilidade",
                description: "Ensinar uma habilidade ou outro ensinamento √∫til ao seu parceiro.",
                details: "Voc√™ vai ensinar ao seu Parceiro Oficial algo que voc√™ faz bem e pratica. Pode ser qualquer habilidade ou conhecimento pr√°tico que seja √∫til a ele.",
                category: "discipline"
            },
            {
                id: 19,
                title: "Caminhada do Amor",
                description: "Convidar sua esposa/noiva/namorada para fazer a Caminhada do Amor.",
                details: "Voc√™ vai convidar sua amada para fazer a Caminhada do Amor. Se voc√™ √© solteiro, pode convidar algu√©m que tenha em vista ou motivar um casal a fazer.",
                category: "discipline",
                links: [
                    { text: "üíï P√°gina oficial da Caminhada do Amor", url: "http://rna.to/1mI1s2e" },
                    { text: "üòÑ Humor: Precisamos conversar", url: "http://rna.to/1pnsd2l" }
                ]
            },
            {
                id: 20,
                title: "√Årea de Excel√™ncia",
                description: "Descobrir sua √°rea de excel√™ncia e desenvolv√™-la.",
                details: "Voc√™ vai identificar sua √°rea de excel√™ncia e come√ßar a fazer mais para desenvolv√™-la. Todo mundo pode ser excelente em pelo menos uma coisa.",
                category: "excellence"
            },
            {
                id: 21,
                title: "Come√ßar como o Rei Davi",
                description: "Come√ßar todos os dias desta semana como o rei Davi.",
                details: "Voc√™ vai se programar para passar alguns minutos diante de Deus em ora√ß√£o ao come√ßar o dia, seguindo o exemplo do rei Davi.",
                category: "excellence"
            },
            {
                id: 22,
                title: "Eliminar Mau H√°bito",
                description: "Identificar um mau h√°bito e elimin√°-lo.",
                details: "Voc√™ vai identificar pelo menos um mau h√°bito e elimin√°-lo. Forme h√°bitos bons e sua vida ser√° boa. H√°bitos ruins a destruir√£o.",
                category: "excellence",
                links: [
                    { text: "üìñ Sendo mais esperto que seu h√°bito", url: "http://rna.to/1rBI7l3" },
                    { text: "üìñ Quebrando h√°bitos: habilitadores e acionadores", url: "http://rna.to/1pLU1ek" }
                ]
            },
            {
                id: 23,
                title: "Adotar Bom H√°bito",
                description: "Adotar um novo bom h√°bito.",
                details: "Voc√™ vai definir um bom h√°bito que lhe trar√° bons resultados e desenvolv√™-lo at√© que se torne natural. Normalmente demora de 21 a 40 dias para desenvolver um bom h√°bito.",
                category: "excellence"
            },
            {
                id: 24,
                title: "Aprender 'Sim' e 'N√£o'",
                description: "Aprender a dizer 'sim' e 'n√£o' mais corajosamente.",
                details: "Voc√™ vai prestar mais aten√ß√£o aos seus 'sins' e 'n√£os', especialmente os mais importantes. Aprenda a us√°-los corretamente para ter melhores resultados.",
                category: "excellence"
            },
            {
                id: 25,
                title: "Desenvolver Maturidade",
                description: "Identificar imaturidade e desenvolver a maturidade.",
                details: "Voc√™ vai avaliar o seu n√≠vel de maturidade e ver onde precisa desenvolv√™-la mais. Ser maduro √© estar bem ajustado √† sua √©poca e situa√ß√£o.",
                category: "excellence"
            },
            {
                id: 26,
                title: "Revis√£o e Divulga√ß√£o 2",
                description: "Rever todos os desafios at√© aqui, se atualizar no projeto e divulgar o IntelliMen.",
                details: "Chegou outro momento de reflex√£o. Voc√™ vai revisar seu desempenho desde o desafio 18 e divulgar o projeto de alguma forma extra.",
                category: "excellence",
                links: [
                    { text: "üìñ Onde comprar o livro IntelliMen", url: "https://arcacenter.com.br/livrointellimen" }
                ]
            },
            {
                id: 27,
                title: "Terminar Projeto Abandonado",
                description: "Terminar um projeto que abandonou.",
                details: "Voc√™ vai identificar um projeto, ideia, tarefa ou prop√≥sito que tenha abandonado e dar continuidade at√© termin√°-lo. Homens inteligentes terminam o que come√ßam.",
                category: "excellence"
            },
            {
                id: 28,
                title: "Resolver Problema Interessante",
                description: "Resolver um problema interessante ‚Äî seu ou de algu√©m.",
                details: "Voc√™ vai encontrar um problema interessante que voc√™ pode resolver e que vale a pena resolver. Homens s√£o solucionadores de problemas.",
                category: "excellence"
            },
            {
                id: 29,
                title: "Ler Livro Edificante",
                description: "Ler um livro edificante nos pr√≥ximos 30 dias.",
                details: "Voc√™ vai escolher e ler um livro edificante dentro de 30 dias. Sabedoria e conhecimento valem mais que m√∫sculos.",
                category: "excellence",
                links: [
                    { text: "üìö Loja de livros recomendados", url: "http://arcacenter.com.br" },
                    { text: "üìû Televendas", url: "tel:+552124610060" }
                ]
            },
            {
                id: 30,
                title: "Usar Negatividade como Combust√≠vel",
                description: "Usar a negatividade dos outros a seu respeito como combust√≠vel para conseguir o que quer.",
                details: "Voc√™ vai identificar algum sonho que foi sufocado pela negatividade dos outros e usar essa negatividade como energia para persegui-lo.",
                category: "excellence",
                links: [
                    { text: "üé¨ Hist√≥ria real de Carl Brashear", url: "https://pt.wikipedia.org/wiki/Homens_de_Honra" }
                ]
            },
            {
                id: 31,
                title: "Peso Saud√°vel",
                description: "Identificar seu peso saud√°vel e ajustar sua alimenta√ß√£o e atividade f√≠sica.",
                details: "Voc√™ vai descobrir como est√° o seu peso e massa corporal e, se necess√°rio, fazer ajustes na alimenta√ß√£o e exerc√≠cios.",
                category: "excellence",
                links: [
                    { text: "üßÆ Calculadora de IMC", url: "http://rna.to/SPRMen" }
                ]
            },
            {
                id: 32,
                title: "Equilibrar Emo√ß√µes",
                description: "Emotivo demais ou de menos? Confronte e equilibre suas emo√ß√µes.",
                details: "Voc√™ vai confrontar seus h√°bitos emocionais, identificar fraquezas e lidar com eles para alcan√ßar o equil√≠brio emocional.",
                category: "excellence"
            },
            {
                id: 33,
                title: "Ser Pontual",
                description: "Ser pontual em todos os seus compromissos desta semana (e depois, sempre).",
                details: "Voc√™ vai observar e se programar para n√£o fazer nada atrasado. Pontualidade √© uma das caracter√≠sticas das pessoas de sucesso.",
                category: "excellence"
            },
            {
                id: 34,
                title: "Dinheiro Extra Criativo",
                description: "Fazer um dinheiro extra de forma criativa.",
                details: "Voc√™ vai fazer um dinheiro extra usando sua criatividade para desenvolver suas habilidades empreendedoras.",
                category: "excellence",
                links: [
                    { text: "üòÑ O que mudou entre 1990 e hoje", url: "http://rna.to/1oTJ7qW" }
                ]
            },
            {
                id: 35,
                title: "Verdades sobre o Tempo",
                description: "Entender as verdades sobre o tempo e aprender a respeit√°-lo.",
                details: "Voc√™ vai meditar sobre textos importantes sobre o tempo e assistir a um v√≠deo que mudar√° sua perspectiva sobre como usar o tempo.",
                category: "excellence",
                links: [
                    { text: "üé• Coisas que voc√™ n√£o sabia sobre o tempo", url: "http://rna.to/1n7mgle" }
                ]
            },
            {
                id: 36,
                title: "Surpresa para a Mulher Amada",
                description: "Fazer uma surpresa agrad√°vel para a mulher que voc√™ ama.",
                details: "Voc√™ vai planejar e fazer uma surpresa agrad√°vel para a mulher especial em sua vida, seja esposa, m√£e, irm√£, filha ou namorada.",
                category: "excellence"
            },
            {
                id: 37,
                title: "Fazer o Certo Sem Vontade",
                description: "Aprender a fazer o que √© certo com ou sem vontade.",
                details: "Voc√™ vai desenvolver a habilidade de fazer o que √© certo mesmo quando n√£o tem vontade. Sentir vontade √© opcional para fazer o que √© certo.",
                category: "excellence",
                links: [
                    { text: "üé• Princ√≠pio dos 5 minutos", url: "http://rna.to/1ogQho1" }
                ]
            },
            {
                id: 38,
                title: "Jejum de Daniel",
                description: "Fazer o Jejum de Daniel por 21 dias.",
                details: "Voc√™ vai fazer o Jejum de Daniel - um desafio de se desconectar do bombardeio de informa√ß√µes por 21 dias para focar no fortalecimento espiritual.",
                category: "excellence",
                links: [
                    { text: "üìñ Explica√ß√£o completa do Jejum de Daniel", url: "http://rna.to/1kqo5a2" }
                ]
            },
            {
                id: 39,
                title: "Planejar o Dia",
                description: "Planejar o seu dia na noite anterior.",
                details: "Voc√™ vai tirar alguns minutos no final da noite para escrever uma lista das coisas principais que tem de fazer no dia seguinte.",
                category: "excellence"
            },
            {
                id: 40,
                title: "Buscar Ajuda",
                description: "Buscar ajuda.",
                details: "Voc√™ vai identificar uma √°rea onde precisa de ajuda e procurar quem pode ajud√°-lo. Admitir fraqueza √© sinal de for√ßa.",
                category: "impact",
                links: [
                    { text: "üìñ Sobre humildade e pedir ajuda", url: "http://rna.to/1r97JHb" }
                ]
            },
            {
                id: 41,
                title: "Oferecer Ajuda",
                description: "Oferecer ajuda a um homem que precise.",
                details: "Voc√™ vai identificar um homem que esteja precisando de ajuda e oferec√™-la da melhor forma que puder.",
                category: "impact"
            },
            {
                id: 42,
                title: "Proibir Palavras Negativas",
                description: "Proibir-se de usar certas palavras negativas.",
                details: "Voc√™ vai identificar palavras negativas que costuma usar, proibir-se de us√°-las e substitu√≠-las por outras melhores.",
                category: "impact"
            },
            {
                id: 43,
                title: "Gestos de Generosidade",
                description: "Praticar pelo menos tr√™s gestos de generosidade esta semana.",
                details: "Voc√™ vai fazer pelo menos tr√™s gestos de generosidade, sem interesse pessoal, simplesmente para fazer o bem a algu√©m. Todo IntelliMan √© generoso.",
                category: "impact"
            },
            {
                id: 44,
                title: "Revis√£o e Leitura",
                description: "Rever os desafios desde o 27 at√© o 43 e fazer a leitura da semana.",
                details: "Chegou outro momento de reflex√£o. Voc√™ vai revisar desde o desafio 27 at√© o 43 e meditar em Hebreus 11 sobre homens corajosos da hist√≥ria.",
                category: "impact"
            },
            {
                id: 45,
                title: "Dominar a Raiva",
                description: "Aprender a dominar a raiva e us√°-la a seu favor.",
                details: "Voc√™ vai aprender a dominar sua raiva e identificar a mensagem que ela traz. A raiva √© um sinal de que algo contrariou suas expectativas.",
                category: "impact",
                links: [
                    { text: "üìñ A origem da raiva", url: "http://rna.to/1hQTrMy" }
                ]
            },
            {
                id: 46,
                title: "Pornografia no C√©rebro",
                description: "Assistir ao v√≠deo 'Pornografia no C√©rebro'.",
                details: "Voc√™ vai assistir a um document√°rio sobre os danos da pornografia e se informar sobre este assunto que afeta muitos homens hoje.",
                category: "impact",
                links: [
                    { text: "üé• Document√°rio: Pornografia no C√©rebro", url: "http://rna.to/1paseJ1" }
                ]
            },
            {
                id: 47,
                title: "Bloquear Pornografia",
                description: "Bloquear a pornografia da sua vida e blindar-se contra ela.",
                details: "Voc√™ vai tomar medidas pr√°ticas para bloquear toda oportunidade de contato com pornografia e blindar-se contra ela.",
                category: "impact",
                links: [
                    { text: "üé• Por que os homens olham?", url: "http://rna.to/1sYM3AD" },
                    { text: "üé• Sobre dom√≠nio pr√≥prio", url: "http://rna.to/1oRUM65" }
                ]
            },
            {
                id: 48,
                title: "Vingar-se Fazendo o Bem",
                description: "Vingar-se do mal que lhe fez sofrer, fazendo o bem.",
                details: "Voc√™ vai identificar o mal que sofreu e decidir como se vingar√° desse mal fazendo o bem. Fa√ßa o diabo pagar caro!",
                category: "impact",
                links: [
                    { text: "üìñ Projetos do autor", url: "http://rna.to/1xNzrPq" }
                ]
            },
            {
                id: 49,
                title: "Assumir Erros",
                description: "Assumir seus erros e pedir desculpas.",
                details: "Voc√™ vai reconhecer seus erros, assumi-los e pedir desculpas a quem deve. Ser homem inteligente √© saber que n√£o sabe tudo.",
                category: "impact"
            },
            {
                id: 50,
                title: "Sair com Parceiro",
                description: "Sair com seu parceiro oficial para curtirem alguma atividade juntos.",
                details: "Voc√™ vai tirar um tempo para fazer algo que voc√™s dois gostem. Homens precisam de amigos que sejam influ√™ncia positiva.",
                category: "impact"
            },
            {
                id: 51,
                title: "Influ√™ncias nas Decis√µes",
                description: "Entender como suas decis√µes s√£o influenciadas e ficar mais atento a isso.",
                details: "Voc√™ vai assistir a uma palestra sobre como nossas decis√µes s√£o influenciadas e aprender a ficar mais atento a essas influ√™ncias.",
                category: "impact",
                links: [
                    { text: "üé• Palestra de Dan Ariely sobre decis√µes", url: "http://rna.to/1pnvm1X" }
                ]
            },
            {
                id: 52,
                title: "Encontro com Homens",
                description: "Organizar um encontro com homens para falar do IntelliMen.",
                details: "Voc√™ vai organizar um encontro para falar sobre como o projeto o tem ajudado e motivar outros homens a participar.",
                category: "impact"
            },
            {
                id: 53,
                title: "Revis√£o Final",
                description: "Certificar-se de ter cumprido todos os 52 desafios. Todos.",
                details: "Voc√™ vai revisar rigorosamente todos os desafios para garantir que cumpriu todos √† risca. Miss√£o dada √© miss√£o cumprida. Um IntelliMan √© um homem inteligente que termina o que come√ßou.",
                category: "impact"
            }
        ];

        // Elementos DOM
        const authSection = document.getElementById('authSection');
        const dashboard = document.getElementById('dashboard');
        const loginTab = document.getElementById('loginTab');
        const registerTab = document.getElementById('registerTab');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');

        // Fun√ß√µes de autentica√ß√£o
        function showAuthForm(formType) {
            loginTab.classList.remove('active');
            registerTab.classList.remove('active');
            loginForm.classList.remove('active');
            registerForm.classList.remove('active');
            
            if (formType === 'login') {
                loginTab.classList.add('active');
                loginForm.classList.add('active');
            } else {
                registerTab.classList.add('active');
                registerForm.classList.add('active');
            }
        }

        // Event listeners para as abas
        loginTab.addEventListener('click', () => showAuthForm('login'));
        registerTab.addEventListener('click', () => showAuthForm('register'));

        // Fun√ß√£o de login
        async function login(event) {
            event.preventDefault();
            showLoading();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    localStorage.setItem('token', data.token);
                    currentUser = data.user;
                    await showDashboard();
                    showToast('Login realizado com sucesso! üéâ');
                } else {
                    showToast(data.error || 'Email ou senha incorretos', 'error');
                }
            } catch (error) {
                showToast('Erro de conex√£o. Tente novamente.', 'error');
            } finally {
                hideLoading();
            }
        }

        // Fun√ß√£o de registro
        async function register(event) {
            event.preventDefault();
            showLoading();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const partner = document.getElementById('registerPartner').value;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, password, partner })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showToast('Cadastro realizado com sucesso! Fa√ßa login agora.');
                    document.getElementById('actualRegisterForm').reset();
                    setTimeout(() => showAuthForm('login'), 2000);
                } else {
                    showToast(data.error || 'Erro ao cadastrar usu√°rio', 'error');
                }
            } catch (error) {
                showToast('Erro de conex√£o. Tente novamente.', 'error');
            } finally {
                hideLoading();
            }
        }

        // Fun√ß√£o para mostrar dashboard
        async function showDashboard() {
            authSection.style.display = 'none';
            dashboard.classList.add('active');
            
            // Atualizar informa√ß√µes do usu√°rio
            updateUserInfo();
            
            // Carregar dados
            await Promise.all([
                loadUserProgress(),
                loadChallenges(),
                updateStatistics()
            ]);
        }

        // Atualizar informa√ß√µes do usu√°rio
        function updateUserInfo() {
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('partnerName').textContent = currentUser.partner || 'N√£o definido';
            
            // Avatar com iniciais
            const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
            document.getElementById('userAvatar').textContent = initials;
        }

        // Carregar progresso do usu√°rio
        async function loadUserProgress() {
            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE_URL}/api/progress`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (response.ok) {
                    userProgress = await response.json();
                } else if (response.status === 401) {
                    logout();
                    return;
                }
            } catch (error) {
                console.error('Erro ao carregar progresso:', error);
                showToast('Erro ao carregar progresso', 'error');
            }
        }

        // Carregar e renderizar desafios
        async function loadChallenges() {
            allChallenges = challenges;
            renderChallenges(allChallenges);
        }

        // Renderizar desafios
        function renderChallenges(challengesToRender) {
            const grid = document.getElementById('challengesGrid');
            grid.innerHTML = '';
            
            // Converter array de progresso em mapa
            const progressMap = {};
            userProgress.forEach(p => {
                progressMap[p.challenge_id] = p;
            });
            
            challengesToRender.forEach(challenge => {
                const progress = progressMap[challenge.id];
                const isCompleted = progress && progress.completed;
                
                const card = document.createElement('div');
                card.className = `challenge-card ${isCompleted ? 'completed' : ''}`;
                card.onclick = () => openChallengeModal(challenge, progress);
                
                let linksHtml = '';
                if (challenge.links && challenge.links.length > 0) {
                    linksHtml = `
                        <div class="challenge-links">
                            ${challenge.links.map(link => 
                                `<a href="${link.url}" target="_blank" class="challenge-link" onclick="event.stopPropagation()">${link.text}</a>`
                            ).join('')}
                        </div>
                    `;
                }
                
                card.innerHTML = `
                    <div class="challenge-header">
                        <span class="challenge-number">#${challenge.id}</span>
                        <span class="challenge-status ${isCompleted ? 'completed' : 'pending'}">
                            ${isCompleted ? 'Conclu√≠do' : 'Pendente'}
                        </span>
                    </div>
                    <div class="challenge-title">${challenge.title}</div>
                    <div class="challenge-description">${challenge.description}</div>
                    ${linksHtml}
                    <div class="challenge-progress">
                        <button class="btn ${isCompleted ? 'btn-success' : 'btn-secondary'}" onclick="event.stopPropagation(); openChallengeModal(challenges.find(c => c.id === ${challenge.id}), ${JSON.stringify(progress)})">
                            <span>${isCompleted ? '‚úÖ' : 'üìù'}</span>
                            <span>${isCompleted ? 'Ver Detalhes' : 'Come√ßar'}</span>
                        </button>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        // Atualizar estat√≠sticas
        function updateStatistics() {
            const completed = userProgress.filter(p => p.completed).length;
            const total = challenges.length;
            const percentage = Math.round((completed / total) * 100);
            
            document.getElementById('completedChallenges').textContent = completed;
            document.getElementById('progressPercentage').textContent = `${percentage}%`;
            document.getElementById('progressText').textContent = `${completed}/${total} desafios conclu√≠dos`;
            document.getElementById('progressBar').style.width = `${percentage}%`;
            
            // Calcular streak e dias ativos (simulado)
            document.getElementById('currentStreak').textContent = Math.min(completed, 7);
            document.getElementById('daysActive').textContent = Math.max(1, completed * 2);
            
            // Atualizar n√≠vel do usu√°rio
            updateUserLevel(completed);
        }

        // Atualizar n√≠vel do usu√°rio
        function updateUserLevel(completed) {
            let level, emoji;
            
            if (completed >= 50) {
                level = 'IntelliMan TOP 5';
                emoji = 'üëë';
            } else if (completed >= 30) {
                level = 'IntelliMan Fera';
                emoji = 'üî•';
            } else if (completed >= 15) {
                level = 'IntelliMan Esfor√ßado';
                emoji = 'üí™';
            } else if (completed >= 5) {
                level = 'IntelliMan B√°sico';
                emoji = 'üéØ';
            } else {
                level = 'Iniciante';
                emoji = 'üìö';
            }
            
            const levelBadge = document.getElementById('levelBadge');
            const userLevel = document.getElementById('userLevel');
            
            levelBadge.innerHTML = `<span>${emoji}</span><span>${level}</span>`;
            userLevel.textContent = level;
        }

        // Filtros de desafios
        document.addEventListener('DOMContentLoaded', function() {
            const filterButtons = document.querySelectorAll('.filter-btn');
            
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remover active de todos os bot√µes
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    // Adicionar active ao bot√£o clicado
                    this.classList.add('active');
                    
                    const filter = this.dataset.filter;
                    filterChallenges(filter);
                });
            });
        });

        // Filtrar desafios
        function filterChallenges(filter) {
            let filteredChallenges = [...allChallenges];
            
            const progressMap = {};
            userProgress.forEach(p => {
                progressMap[p.challenge_id] = p;
            });
            
            switch (filter) {
                case 'completed':
                    filteredChallenges = allChallenges.filter(c => 
                        progressMap[c.id] && progressMap[c.id].completed
                    );
                    break;
                case 'pending':
                    filteredChallenges = allChallenges.filter(c => 
                        !progressMap[c.id] || !progressMap[c.id].completed
                    );
                    break;
                case 'foundation':
                case 'discipline':
                case 'excellence':
                case 'impact':
                    filteredChallenges = allChallenges.filter(c => c.category === filter);
                    break;
                default:
                    // 'all' - mostrar todos
                    break;
            }
            
            renderChallenges(filteredChallenges);
        }

        // Abrir modal de desafio
        function openChallengeModal(challenge, progress) {
            currentChallengeId = challenge.id;
            
            document.getElementById('modalTitle').innerHTML = `
                <span>üéØ</span>
                <span>Desafio #${challenge.id}: ${challenge.title}</span>
            `;
            
            let linksHtml = '';
            if (challenge.links && challenge.links.length > 0) {
                linksHtml = `
                    <hr style="margin: 25px 0; border: 1px solid var(--border-color);">
                    <h4 style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <span>üîó</span>
                        <span>Links √öteis</span>
                    </h4>
                    <div class="challenge-links">
                        ${challenge.links.map(link => 
                            `<a href="${link.url}" target="_blank" class="challenge-link">${link.text}</a>`
                        ).join('')}
                    </div>
                `;
            }
            
            // Categoria do desafio
            const categoryNames = {
                foundation: 'üèóÔ∏è Funda√ß√£o',
                discipline: 'üí™ Disciplina',
                excellence: 'üéØ Excel√™ncia',
                impact: 'üöÄ Impacto'
            };
            
            const categoryBadge = challenge.category ? 
                `<div style="display: inline-block; background: var(--accent-color); padding: 8px 16px; border-radius: 50px; font-size: 0.9rem; font-weight: 600; margin-bottom: 20px; border: 1px solid var(--border-color);">
                    ${categoryNames[challenge.category] || challenge.category}
                </div>` : '';
            
            document.getElementById('modalContent').innerHTML = `
                ${categoryBadge}
                <h4 style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                    <span>üìã</span>
                    <span>Descri√ß√£o</span>
                </h4>
                <p style="margin-bottom: 25px; line-height: 1.6;">${challenge.description}</p>
                
                <h4 style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                    <span>üìñ</span>
                    <span>Detalhes do Desafio</span>
                </h4>
                <p style="margin-bottom: 20px; line-height: 1.6;">${challenge.details}</p>
                ${linksHtml}
            `;
            
            // Carregar anota√ß√µes existentes
            const notes = progress ? progress.notes || '' : '';
            document.getElementById('challengeNotes').value = notes;
            
            // Configurar bot√£o de conclus√£o
            const completeBtn = document.getElementById('completeBtn');
            const isCompleted = progress && progress.completed;
            
            if (isCompleted) {
                completeBtn.innerHTML = `
                    <span>‚úèÔ∏è</span>
                    <span>Atualizar Anota√ß√µes</span>
                `;
                completeBtn.className = 'btn btn-secondary btn-full';
            } else {
                completeBtn.innerHTML = `
                    <span>‚úÖ</span>
                    <span>Salvar e Marcar como Conclu√≠do</span>
                `;
                completeBtn.className = 'btn btn-success btn-full';
            }
            
            document.getElementById('challengeModal').classList.add('active');
        }

        // Fechar modal de desafio
        function closeChallengeModal() {
            document.getElementById('challengeModal').classList.remove('active');
            currentChallengeId = null;
        }

        // Completar desafio
        async function completeChallenge() {
            if (!currentChallengeId) return;
            
            showLoading();
            const notes = document.getElementById('challengeNotes').value;
            const token = localStorage.getItem('token');
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/progress/${currentChallengeId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        completed: true,
                        notes: notes
                    })
                });
                
                if (response.ok) {
                    showToast('Desafio atualizado com sucesso! üéâ');
                    closeChallengeModal();
                    
                    // Recarregar dados
                    await loadUserProgress();
                    await loadChallenges();
                    updateStatistics();
                } else if (response.status === 401) {
                    logout();
                    return;
                } else {
                    const data = await response.json();
                    showToast(data.error || 'Erro ao salvar desafio', 'error');
                }
            } catch (error) {
                showToast('Erro de conex√£o. Tente novamente.', 'error');
            } finally {
                hideLoading();
            }
        }

        // Perfil do usu√°rio
        function openProfileModal() {
            document.getElementById('profileName').value = currentUser.name;
            document.getElementById('profileEmail').value = currentUser.email;
            document.getElementById('profilePartner').value = currentUser.partner || '';
            
            loadProfileStats();
            document.getElementById('profileModal').classList.add('active');
        }

        function closeProfileModal() {
            document.getElementById('profileModal').classList.remove('active');
        }

        async function updateProfile(event) {
            event.preventDefault();
            showLoading();
            
            const name = document.getElementById('profileName').value;
            const partner = document.getElementById('profilePartner').value;
            const token = localStorage.getItem('token');
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/user`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ name, partner })
                });
                
                if (response.ok) {
                    currentUser.name = name;
                    currentUser.partner = partner;
                    updateUserInfo();
                    showToast('Perfil atualizado com sucesso! üéâ');
                    closeProfileModal();
                } else if (response.status === 401) {
                    logout();
                    return;
                } else {
                    const data = await response.json();
                    showToast(data.error || 'Erro ao atualizar perfil', 'error');
                }
            } catch (error) {
                showToast('Erro de conex√£o. Tente novamente.', 'error');
            } finally {
                hideLoading();
            }
        }

        function loadProfileStats() {
            const completed = userProgress.filter(p => p.completed).length;
            const total = challenges.length;
            const percentage = ((completed / total) * 100).toFixed(1);
            
            // Calcular estat√≠sticas avan√ßadas
            const categoriesProgress = {
                foundation: { completed: 0, total: 0 },
                discipline: { completed: 0, total: 0 },
                excellence: { completed: 0, total: 0 },
                impact: { completed: 0, total: 0 }
            };
            
            const progressMap = {};
            userProgress.forEach(p => progressMap[p.challenge_id] = p);
            
            challenges.forEach(challenge => {
                const category = challenge.category;
                if (categoriesProgress[category]) {
                    categoriesProgress[category].total++;
                    if (progressMap[challenge.id] && progressMap[challenge.id].completed) {
                        categoriesProgress[category].completed++;
                    }
                }
            });
            
            // Encontrar data de in√≠cio
            const firstActivity = userProgress.find(p => p.completed);
            const startDate = firstActivity ? 
                new Date(firstActivity.completed_at).toLocaleDateString('pt-BR') : 
                'Ainda n√£o iniciado';
            
            document.getElementById('profileStats').innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div style="text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: 900; color: var(--primary-color);">${completed}</div>
                        <div style="color: var(--text-light); font-weight: 600;">Desafios Conclu√≠dos</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 2.5rem; font-weight: 900; color: var(--success-color);">${percentage}%</div>
                        <div style="color: var(--text-light); font-weight: 600;">Progresso Total</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 900; color: var(--primary-color);">${startDate}</div>
                        <div style="color: var(--text-light); font-weight: 600;">Data de In√≠cio</div>
                    </div>
                </div>
                
                <h4 style="margin-bottom: 15px;">üìä Progresso por Categoria</h4>
                ${Object.entries(categoriesProgress).map(([category, stats]) => {
                    const categoryNames = {
                        foundation: 'üèóÔ∏è Funda√ß√£o',
                        discipline: 'üí™ Disciplina', 
                        excellence: 'üéØ Excel√™ncia',
                        impact: 'üöÄ Impacto'
                    };
                    const percent = stats.total > 0 ? Math.round((stats.completed / stats.total) * 100) : 0;
                    return `
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-weight: 600;">${categoryNames[category]}</span>
                                <span style="color: var(--text-light);">${stats.completed}/${stats.total}</span>
                            </div>
                            <div style="background: var(--border-color); height: 8px; border-radius: 4px; overflow: hidden;">
                                <div style="background: var(--success-color); height: 100%; width: ${percent}%; transition: width 0.3s ease;"></div>
                            </div>
                        </div>
                    `;
                }).join('')}
                
                <div style="margin-top: 25px; padding: 20px; background: white; border-radius: var(--border-radius); border: 1px solid var(--border-color);">
                    <h4 style="margin-bottom: 15px;">üèÜ Seu N√≠vel IntelliMan</h4>
                    ${getUserLevelDescription(completed)}
                </div>
            `;
        }

        function getUserLevelDescription(completed) {
            if (completed >= 50) {
                return '<div style="color: #d4af37; font-weight: 700; font-size: 1.1rem;">üåü INTELLIMAN TOP 5 - Liga dos Melhores!</div><p style="margin-top: 10px; color: var(--text-light);">Voc√™ √© um exemplo a ser seguido. Parab√©ns pela dedica√ß√£o!</p>';
            } else if (completed >= 30) {
                return '<div style="color: #cd7f32; font-weight: 700; font-size: 1.1rem;">üî• INTELLIMAN FERA - Voc√™ √© fera!</div><p style="margin-top: 10px; color: var(--text-light);">Excelente progresso! Continue assim!</p>';
            } else if (completed >= 15) {
                return '<div style="color: #c0c0c0; font-weight: 700; font-size: 1.1rem;">üí™ INTELLIMAN ESFOR√áADO - Valeu o esfor√ßo!</div><p style="margin-top: 10px; color: var(--text-light);">Bom progresso! Mantenha o foco!</p>';
            } else if (completed >= 5) {
                return '<div style="color: #8b4513; font-weight: 700; font-size: 1.1rem;">üéØ INTELLIMAN B√ÅSICO - Pelo menos voc√™ tentou!</div><p style="margin-top: 10px; color: var(--text-light);">Continue se esfor√ßando, voc√™ vai conseguir!</p>';
            } else {
                return '<div style="color: var(--text-light); font-weight: 700; font-size: 1.1rem;">üìö INICIANTE - Continue se esfor√ßando!</div><p style="margin-top: 10px; color: var(--text-light);">Todo grande IntelliMan come√ßou do primeiro desafio!</p>';
            }
        }

        // Manifesto
        function openManifestoModal() {
            document.getElementById('manifestoModal').classList.add('active');
        }

        function closeManifestoModal() {
            document.getElementById('manifestoModal').classList.remove('active');
        }

        // Exportar progresso
        async function exportProgress() {
            showLoading();
            
            try {
                const completed = userProgress.filter(p => p.completed).length;
                const completionPercentage = ((completed / 53) * 100).toFixed(1);
                
                let exportText = `# üìä RELAT√ìRIO DE PROGRESSO - INTELLIMEN\n\n`;
                exportText += `## üë§ Dados do Participante\n\n`;
                exportText += `- **Nome:** ${currentUser.name}\n`;
                exportText += `- **Email:** ${currentUser.email}\n`;
                exportText += `- **Parceiro Oficial:** ${currentUser.partner || 'N√£o definido'}\n`;
                exportText += `- **Data do Relat√≥rio:** ${new Date().toLocaleDateString('pt-BR')}\n\n`;
                
                exportText += `## üìà Resumo do Progresso\n\n`;
                exportText += `> **${completed}/53 desafios conclu√≠dos (${completionPercentage}%)**\n\n`;
                
                // Barra de progresso visual
                const progressBar = '‚ñà'.repeat(Math.floor(completed / 53 * 20)) + '‚ñë'.repeat(20 - Math.floor(completed / 53 * 20));
                exportText += `\`\`\`\n${progressBar} ${completionPercentage}%\n\`\`\`\n\n`;
                
                if (completed > 0) {
                    exportText += `## ‚úÖ Desafios Conclu√≠dos\n\n`;
                    
                    challenges.forEach(challenge => {
                        const progress = userProgress.find(p => p.challenge_id === challenge.id && p.completed);
                        if (progress) {
                            exportText += `### ${challenge.id}. ${challenge.title}\n\n`;
                            exportText += `- **Status:** ‚úÖ *Conclu√≠do*\n`;
                            exportText += `- **Data de Conclus√£o:** ${new Date(progress.completed_at).toLocaleDateString('pt-BR')}\n`;
                            
                            if (progress.notes && progress.notes.trim()) {
                                exportText += `- **Anota√ß√µes:**\n  > ${progress.notes.replace(/\n/g, '\n  > ')}\n`;
                            }
                            exportText += `\n---\n\n`;
                        }
                    });
                }
                
                const pendingChallenges = challenges.filter(challenge => 
                    !userProgress.find(p => p.challenge_id === challenge.id && p.completed)
                );
                
                if (pendingChallenges.length > 0) {
                    exportText += `## ‚è≥ Desafios Pendentes\n\n`;
                    exportText += `*${pendingChallenges.length} desafios restantes para completar o projeto:*\n\n`;
                    
                    pendingChallenges.forEach(challenge => {
                        exportText += `- [ ] **Desafio #${challenge.id}:** ${challenge.title}\n`;
                    });
                    exportText += `\n`;
                }
                
                exportText += `## üéØ Lema do IntelliMan\n\n`;
                exportText += `> *"Um IntelliMan √© um homem inteligente. Ele vence a si mesmo, honra sua mulher e ajuda o seu parceiro. Se √© dif√≠cil, ele supera. Se √© assustador, ele enfrenta. Se demora, ele persevera. Conhece o seu valor diante dos homens e de Deus. Ama a disciplina, o car√°ter e o bem. Sua miss√£o √© inspirar outros a se tornarem IntelliMen."*\n\n`;
                
                exportText += `---\n\n*Relat√≥rio gerado em ${new Date().toLocaleString('pt-BR')} via IntelliMen App*\n`;
                
                // Criar e baixar arquivo
                const blob = new Blob([exportText], { type: 'text/markdown;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `intellimen_relatorio_${currentUser.name.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.md`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showToast('üìÑ Relat√≥rio exportado com sucesso!');
            } catch (error) {
                showToast('Erro ao exportar relat√≥rio', 'error');
            } finally {
                hideLoading();
            }
        }

        // Compartilhar progresso
        async function shareProgress() {
            const completed = userProgress.filter(p => p.completed).length;
            const percentage = Math.round((completed / 53) * 100);
            
            const shareText = `üéØ Estou participando do Projeto IntelliMen!\n\nüìä Meu progresso: ${completed}/53 desafios conclu√≠dos (${percentage}%)\n\nüí™ Transformando-me em um homem melhor a cada dia!\n\n#IntelliMen #DesenvolvimentoPessoal #HomensInteligentes\n\nConhe√ßa o projeto: ${window.location.origin}`;
            
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: 'Meu Progresso IntelliMen',
                        text: shareText,
                        url: window.location.origin
                    });
                    showToast('Progresso compartilhado com sucesso! üì±');
                } catch (error) {
                    if (error.name !== 'AbortError') {
                        fallbackShare(shareText);
                    }
                }
            } else {
                fallbackShare(shareText);
            }
        }

        function fallbackShare(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('Texto copiado para a √°rea de transfer√™ncia! üìã');
            }).catch(() => {
                // Fallback para navegadores mais antigos
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showToast('Texto copiado para a √°rea de transfer√™ncia! üìã');
            });
        }

        // Logout
        function logout() {
            localStorage.removeItem('token');
            currentUser = null;
            userProgress = [];
            authSection.style.display = 'block';
            dashboard.classList.remove('active');
            showToast('Logout realizado com sucesso! üëã');
        }

        // Event listeners
        document.getElementById('actualLoginForm').addEventListener('submit', login);
        document.getElementById('actualRegisterForm').addEventListener('submit', register);

        // Fechar modais ao clicar fora
        window.onclick = function(event) {
            const modals = ['challengeModal', 'manifestoModal', 'profileModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    modal.classList.remove('active');
                }
            });
        }

        // Verificar se usu√°rio est√° logado ao carregar
        window.addEventListener('load', async function() {
            console.log('üì± IntelliMen carregando...');
            showLoading();
            
            const token = localStorage.getItem('token');
            
            if (token) {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/user`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    
                    if (response.ok) {
                        currentUser = await response.json();
                        await showDashboard();
                        console.log('‚úÖ Usu√°rio autenticado automaticamente');
                    } else {
                        localStorage.removeItem('token');
                        console.log('‚ùå Token inv√°lido removido');
                    }
                } catch (error) {
                    console.error('‚ùå Erro ao verificar autentica√ß√£o:', error);
                    localStorage.removeItem('token');
                }
            }
            
            hideLoading();
            console.log('‚úÖ IntelliMen carregado com sucesso!');
        });
    </script>
</body>
</html>